#include <linux/sched.h>

// define output data structure in C
struct data_t {
	u32 pid;
	u64 ts;
	char comm[TASK_COMM_LEN];
};
BPF_PERF_OUTPUT(events);

int trace(struct pt_regs *ctx) {
	struct data_t data = {};

	data.pid = bpf_get_current_pid_tgid();
	data.ts = bpf_ktime_get_ns();
	bpf_get_current_comm(&data.comm, sizeof(data.comm));

	events.perf_submit(ctx, &data, sizeof(data));

	return 0;
}